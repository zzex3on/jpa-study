# 영속성 컨텍스트
- JPA를 이해하는데 가장 중요한 용어
- "엔티티를 영구 저장하는 환경", "영속성 컨텍스트를 통해서 엔티티를 영속화한다"
  ```java
  EntityManager.persist(entity);
  // persist()는 DB에 저장한다는 것이 아니라, 엔티티를 영속성 컨텍스트라는 곳에 저장하는 것을 의미함
  ```
- 논리적인 개념으로 눈에 보이지 않음
- ```EntityManager```를 통해 영속성 컨텍스트에 접근! (1:1)

> JPA에서 가장 중요한 2가지
1. 객체와 관계형 데이터베이스 매핑
2. 영속성 컨텍스트 (JPA가 내부적으로 어떻게 동작하는지 알 수 있음)

## 엔티티의 생명주기
- 비영속 (new/transient) : 영속성 컨텍스트와 전혀 관계가 없는 새로운 상태 (값을 세팅만 해둔, 객체만 생성해둔 상태이자 jpa와 전혀 관계없는 상태임)
  ```java
  Member member = new Member();
  member.setId(2L);
  member.setName("HelloB");
  ```
- 영속 (managed) : 영속성 컨텍스트에 관리되는 상태 (ex. persist()를 사용하였을 때)
  - 영속 상태가 된다고 해서 바로 DB에 저장되는 것은 아님! __트랜잭션을 커밋하는 시점에 영속성 컨텍스트에 저장된 데이터가 쿼리로 저장됨__ ✨ 
  ```java
  // 객체를 생성한 상태 (비영속)
  Member member = new Member();
  member.setId(2L);
  member.setName("HelloB");

  EntityManagerFacoty emf = Persistence.createEntityManagerFactory("unitName");
  EntityManager em = emf.createEntityManager();
  em.getTransaction().begin();

  // 객체를 영속 컨텍스트인 EntityManager에 저장한 상태 (영속)
  em.persist(member);
  ```
- 준영속 (detached) : 영속성 컨텍스트에 저장되었다가 분리된 상태
  ```java
  // 영속성 컨텍스트에서 지움 -> 관계가 사라짐 
  em.detach(member);
  ```
- 삭제 (removed) : 삭제된 상태
  ```java
  // 객체를 삭제 = 실제 DB 데이터 삭제 요청  
  em.remove(member);
  ```
- - -
## 영속성 컨텍스트의 이점
1. 
